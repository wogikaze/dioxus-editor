# 07-notation-inline: インライン記法パーサ（太字・斜体・チェックボックスなど）

## ゴール

- 記法仕様のうち、1 行内で完結するインライン記法を実装する。
- N-01〜N-11 を中心としたテストを通す。

## 対象記法（このステップ）

- `[* text]` 太字
- `[/ text]` 斜体
- `[- text]` 打ち消し線
- `[_ text]` 下線
- `[| text]` 中央寄せ
- `[> text]` 右寄せ
- `[# ...]` 系の見出し（行頭）
- `[" text]` インライン引用
- `[ ]` / `[x]` チェックボックス
- `` `text` `` インラインコード
- `#tag` タグ（自動補完は別ステップ）

## 実装方針

- モデル層では `Line.text` は「プレーン文字列」のままとし、レンダリング時に簡易パーサで解釈する。
- Dioxus の `rsx!` 内で「行ごとのレンダリング関数」を作り、記法に応じてタグを切り替える。
- コードブロック内・ LaTeX ブロック内では記法を解釈せず生文字列として扱う（後続ステップで対応）。

## 手順

1. 行レンダリングヘルパの抽出
   - `fn render_line(line: &Line) -> Element` のような関数を用意して、記法解釈を集中させる。

2. 見出し記法（行頭 `[### text]`）
   - 正規表現または手書きパーサで、`^[\[]#+\s+` 形式を検出。
   - `#` の数に応じて `h1`〜`h6` に切り替える。
   - エラーケース（閉じ `]` なし）では平文表示とする（E-303）。

3. チェックボックス `[ ]` / `[x]`
   - 行頭が `[ ]` or `[x]` の場合、Checkbox と本文に分割する。
   - チェックボックス部分はクリック時に `[ ]` ⇔ `[x]` の文字列を書き換える。

4. その他のインライン装飾
   - `[~ prefix]` のようなプレフィックス記法は、テキスト開始位置を検出して適切なスタイルで囲む。
   - インライン引用 `[" text]` は `<q>` または `<span class="inline-quote">` などで表示。

5. インラインコード `` `code` ``
   - シンプルなトークナイザでバッククオートのペアを検出し、`<code>` で囲む。
   - コードブロック内では処理しない設計にしておく（後続でブロック検出を先に行う）。

6. タグ `#tag`
   - 単語の先頭 `#` からスペース/行末までをタグとして検出。
   - レンダリング上は `<span class="tag">` などで表示。
   - 自動補完は 10 以降に実装予定とし、このステップでは単純なハイライトのみ行う。

## Definition of Done

- N-01〜N-11 のテストケースに対して、目視で正しくスタイルが適用される。
- 壊れた記法（閉じ忘れなど）があってもフリーズせず、なにかしら安定した表示になる。
