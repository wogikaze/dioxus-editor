# 08-blocks-links-media: リンク・画像・コードブロック・LaTeX

## ゴール

- リンクや画像、YouTube、コードブロック、テーブル、LaTeX ブロックなどのブロック記法を実装する。
- L-01〜L-08, BK-01〜BK-04 のテストを通す。

## 実装方針

- Document レベルで「ブロック構造」を検出し、`Line` とは別に `Block` の概念を持たせるか、
- もしくは「ブロック開始行/終了行」を `Line` のメタ情報として付加する。
- 最初は実装コストを抑えるため「レンダリング時にブロックを判別」する方式を採る。

## 手順

1. URL と相対リンク (L-01〜L-05)
   - `https://` から始まるトークンを `<a href="...">` でレンダリング。
   - `[url]`, `[url text]` 形式をパースし、`href`と表示テキストを分離。
   - `[page]` の行にフォーカスがある場合は生テキスト、フォーカスが外れた場合はリンク化する挙動を実装。

2. 画像・YouTube (L-06〜L-08)
   - `[imageurl]` / `[imageurl text]` / `[text imageurl]` をパース。
   - `<img>` を表示し、クリックでモーダル拡大。
   - `[youtubeurl]` は `<iframe>` 埋め込みでプレイヤーを表示。

3. コードブロック (BK-01)
   - `[```lang name ... ```]` 形式を検出するロジックを追加。
   - 開始行から終了行までをひとつの `<pre><code>` ブロックとしてレンダリング。
   - ブロック内ではインライン記法を解釈しない（E-305）。

4. テーブルブロック (BK-02)
   - `[table name ... ]` ブロックを検出。
   - 行を `|` で split し、ヘッダ行 + データ行として `<table>` でレンダリング。

5. LaTeX 数式 (BK-03, BK-04)
   - `[$ ...]`（インライン）、`[$$ ... $$]`（ブロック）を検出。
   - 数式レンダリングは一旦プレースホルダ（単なる `<span>` / `<div>`）とし、後でライブラリを組み込める構造にしておく。
   - コンパイルエラーにならない形で「プレビュー用コンポーネント」を用意。

## Definition of Done

- L-01〜L-08, BK-01〜BK-04 のテスト項目を手動で確認し、期待動作になっている。
- ブロック内でインライン記法が誤って解釈されない。
